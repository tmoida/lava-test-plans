{% extends "testcases/templates/master.jinja2" %}

{% set test_name = test_name | default("pre-merge-audio") %}
{% set test_timeout = 10 %}

{# Get excluded tests list from device file #}
{% set EXCLUDED_TESTS = EXCLUDED_TESTS|default([]) %}

{# Define all tests with their details and pre-evaluate conditions #}
{% set all_tests = [
    {"name": "AudioPlayback_Config01", "path": "Runner/suites/Multimedia/Audio/AudioPlayback/AudioPlayback.yaml", "include": (AUDIO_CLIPS_URL is defined and AUDIO_CLIPS_URL), "params": {"AUDIO_CLIPS_BASE_DIR": "/home/AudioClips/", "CLIP_NAMES": "playback_config1", "RES_SUFFIX": "Config01"}, "expected": ["AudioPlayback_Config01"]},
    {"name": "AudioPlayback_Config03", "path": "Runner/suites/Multimedia/Audio/AudioPlayback/AudioPlayback.yaml", "include": (AUDIO_CLIPS_URL is defined and AUDIO_CLIPS_URL), "params": {"AUDIO_CLIPS_BASE_DIR": "/home/AudioClips/", "CLIP_NAMES": "playback_config3", "RES_SUFFIX": "Config03"}, "expected": ["AudioPlayback_Config03"]},
    {"name": "AudioPlayback_Config05", "path": "Runner/suites/Multimedia/Audio/AudioPlayback/AudioPlayback.yaml", "include": (AUDIO_CLIPS_URL is defined and AUDIO_CLIPS_URL), "params": {"AUDIO_CLIPS_BASE_DIR": "/home/AudioClips/", "CLIP_NAMES": "playback_config5", "RES_SUFFIX": "Config05"}, "expected": ["AudioPlayback_Config05"]},
    {"name": "AudioPlayback_Config07", "path": "Runner/suites/Multimedia/Audio/AudioPlayback/AudioPlayback.yaml", "include": (AUDIO_CLIPS_URL is defined and AUDIO_CLIPS_URL), "params": {"AUDIO_CLIPS_BASE_DIR": "/home/AudioClips/", "CLIP_NAMES": "playback_config7", "RES_SUFFIX": "Config07"}, "expected": ["AudioPlayback_Config07"]},
    {"name": "AudioPlayback_Config09", "path": "Runner/suites/Multimedia/Audio/AudioPlayback/AudioPlayback.yaml", "include": (AUDIO_CLIPS_URL is defined and AUDIO_CLIPS_URL), "params": {"AUDIO_CLIPS_BASE_DIR": "/home/AudioClips/", "CLIP_NAMES": "playback_config9", "RES_SUFFIX": "Config09"}, "expected": ["AudioPlayback_Config09"]},
    {"name": "AudioRecord_Config01", "path": "Runner/suites/Multimedia/Audio/AudioRecord/AudioRecord.yaml", "params": {"CONFIG_NAMES": "record_config1", "RES_SUFFIX": "Config01"}, "expected": ["AudioRecord_Config01"]},
    {"name": "AudioRecord_Config03", "path": "Runner/suites/Multimedia/Audio/AudioRecord/AudioRecord.yaml", "params": {"CONFIG_NAMES": "record_config3", "RES_SUFFIX": "Config03"}, "expected": ["AudioRecord_Config03"]},
    {"name": "AudioRecord_Config05", "path": "Runner/suites/Multimedia/Audio/AudioRecord/AudioRecord.yaml", "params": {"CONFIG_NAMES": "record_config5", "RES_SUFFIX": "Config05"}, "expected": ["AudioRecord_Config05"]},
    {"name": "AudioRecord_Config07", "path": "Runner/suites/Multimedia/Audio/AudioRecord/AudioRecord.yaml", "params": {"CONFIG_NAMES": "record_config7", "RES_SUFFIX": "Config07"}, "expected": ["AudioRecord_Config07"]},
    {"name": "AudioRecord_Config09", "path": "Runner/suites/Multimedia/Audio/AudioRecord/AudioRecord.yaml", "params": {"CONFIG_NAMES": "record_config9", "RES_SUFFIX": "Config09"}, "expected": ["AudioRecord_Config09"]}
] %}

{% block test_target %}
  {{ super() }}
    {% for test in all_tests %}
    {# Check if test should be included (not excluded AND condition met if specified) #}
    {% if (test.name not in EXCLUDED_TESTS) and (test.include|default(true)) %}
    - from: git
      name: "{{ test.name }}"
      path: {{ test.path }}
      repository: {{ TEST_DEFINITIONS_REPOSITORY }}
      {% if test.params is defined %}
      params:
        {% for param_key, param_value in test.params.items() %}
        {{ param_key }}: "{{ param_value }}"
        {% endfor %}
      {% endif %}
      {% if test.expected is defined and test.expected %}
      expected:
        {% for expected in test.expected|default([]) %}
        - {{ expected }}
        {% endfor %}
      {% endif %}

    {% endif %}
    {% endfor %}
{% endblock test_target %}
